# OutlandMall by Sandro

setvar! timeout 650
clearignore
removelist 'vendors'
createlist 'vendors'
removelist 'items'
createlist 'items'
pushlist 'items' 19239
pushlist 'items' 3862
pushlist 'items' 3877
pushlist 'items' 3885
pushlist 'items' 3873
pushlist 'items' 3859
pushlist 'items' 3865
pushlist 'items' 3856
pushlist 'items' 3878
pushlist 'items' 3861
pushlist 'items' 19236
pushlist 'items' 19234
pushlist 'items' 5901
pushlist 'items' 17087
pushlist 'items' 8032
pushlist 'items' 8033
pushlist 'items' 8031
pushlist 'items' 8035
pushlist 'items' 8029
pushlist 'items' 8034
pushlist 'items' 8037
pushlist 'items' 8041
pushlist 'items' 8042
pushlist 'items' 8039
pushlist 'items' 8038
pushlist 'items' 42694
pushlist 'items' 3657
pushlist 'items' 29774
pushlist 'items' 28883
pushlist 'items' 28885
pushlist 'items' 29773
pushlist 'items' 28879
pushlist 'items' 12215
pushlist 'items' 2597
pushlist 'items' 5362
pushlist 'items' 12686
pushlist 'items' 5356
pushlist 'items' 8455
pushlist 'items' 29348
pushlist 'items' 19239
pushlist 'items' 19227
pushlist 'items' 29103
pushlist 'items' 29863
pushlist 'items' 42692
pushlist 'items' 5363
pushlist 'items' 7127
pushlist 'items' 29447
pushlist 'items' 5127
pushlist 'items' 7109
pushlist 'items' 3908
pushlist 'items' 3897
pushlist 'items' 11552
pushlist 'items' 3718
pushlist 'items' 15178
pushlist 'items' 39860
pushlist 'items' 5359
pushlist 'items' 49711
pushlist 'items' 28888
pushlist 'items' 3897
pushlist 'items' 3985
pushlist 'items' 5356
pushlist 'items' 5981
pushlist 'items' 27611
pushlist 'items' 6464
pushlist 'items' 3530
pushlist 'items' 3836
pushlist 'items' 22336
pushlist 'items' 3843
pushlist 'items' 29025
pushlist 'items' 45285
pushlist 'items' 3842
pushlist 'items' 8826
pushlist 'items' 8901
pushlist 'items' 3834
pushlist 'items' 8787
pushlist 'items' 8786
pushlist 'items' 29036
pushlist 'items' 8012
pushlist 'items' 5903
pushlist 'items' 48407
pushlist 'items' 17686
pushlist 'items' 43167
pushlist 'items' 29030
pushlist 'items' 19235
pushlist 'items' 16898
pushlist 'items' 8788
pushlist 'items' 7107
pushlist 'items' 20495
pushlist 'items' 3827
pushlist 'items' 5356
pushlist 'items' 3920
pushlist 'items' 3713
pushlist 'items' 5117
pushlist 'items' 5042
pushlist 'items' 3721
pushlist 'items' 3762
pushlist 'items' 22187
pushlist 'items' 5078
pushlist 'items' 5187
pushlist 'items' 5049
pushlist 'items' 3568
pushlist 'items' 3911
pushlist 'items' 51100
pushlist 'items' 29048
pushlist 'items' 45085
pushlist 'items' 27612
pushlist 'items' 45085
pushlist 'items' 6264
pushlist 'items' 19232
pushlist 'items' 576
pushlist 'items' 48261
pushlist 'items' 24345
pushlist 'items' 3712
pushlist 'items' 19251
pushlist 'items' 19253

sysmsg "…OutlandMall Start" 23
say "[coords"

while not dead
    if insysmsg "The world will save in"
      while not insysmsg "World save complete."
        pause 1000
      endwhile
      clearsysmsg 
    endif
    @hotkey 'Next Monster Target'
    @setvar! 'vendorID' lasttarget
    if noto 'vendorID' = invulnerable
        getlabel 'vendorID' 'vendorName'
        if inlist 'vendors' 'vendorID'
            # Close all vendor bags
             walk "North"
             walk "South"
             sysmsg "…OutlandMall End" 23
            stop
        else 
            pushlist 'vendors' 'vendorID'
            sysmsg "…vendorStart {{vendorID}} {{vendorName}}" 23
        endif

        if findtype 3701 'vendorID' as mainBackpack
          dclick 'mainBackpack'
          wait timeout
          @ignore mainBackpack
          for x in items
            if findtype x "mainBackpack" as foundItem
              getlabel 'foundItem' foundItemLabel
              sysmsg "…item {{foundItemLabel}}" 23
              @ignore foundItem
            endif
          endfor
          while findtype 3701|29833|3705|3712|3648|3702 mainBackpack as container
              @ignore container
              getlabel container desc
              if "Price: Not for sale" in desc
                dclick container
                wait timeout
                for x in items
                  if findtype x "container" as foundItem
                    getlabel 'foundItem' foundItemLabel
                    sysmsg "…item {{foundItemLabel}}" 23
                    @ignore foundItem
                  endif
                endfor
              elseif "Description: " in desc
                sysmsg "…bag {{foundItemLabel}}" 23
              endif
          endwhile
          sysmsg "…vendorEnd {{vendorID}} {{vendorName}}" 23
        endif
    else 
        sysmsg 'not invul'
    endif
endwhile
